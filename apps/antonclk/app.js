// Importing required fonts
require("FontHaxorNarrow7x17").add(Graphics);

Graphics.prototype.setFontDSEG7ClassicBold = function() {  
  return this.setFontCustom(atob("P/+f/8H/+f/4z/8P/z5/4H/n8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP8AAAAP5/4H/nz/8P/zH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB/4H/gD/8P/wH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/8AAAf/4wAAP/z4ABn/n8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP5/5gAHz/8AADH/+AAAP/+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAD4ABgAH8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP5/5n/nz/8P/zH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/+AAAH/+AAAD/8AAAB/5gAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAAADwAAB/5n/gD/8P/wH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/+AAAH/+AAAz/8AAD5/5gAH8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP4ABn/nwAAP/zAAAf/4AAAf/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/+f/8H/+f/4z/8P/z5/5n/n8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP4ABn/nwAAP/zAAAf/4AAAf/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAA4AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA8AAAAA5/4H/gz/8P/wH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/+f/8H/+f/4z/8P/z5/5n/n8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP5/5n/nz/8P/zH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/+AAAH/+AAAz/8AAD5/5gAH8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP8ADwAP5/5n/nz/8P/zH/+f/4P/+f/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAYAAHgA8AAHgA8AAHgA8AADAAYAA="),
  48,
  atob("GxsbGxsbGxsbGws="),
  36
);
};


Graphics.prototype.setFontDSEG7ClassicBoldMed = function() {  
  return this.setFontCustom(atob("f/v/h/4/5n+D+eAAAH4AAA/AAAH4AAA/AAAH4AAA/AAAH4AAA/AAAH4AAA+AAAHn+D+Z/4/5f/v/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wfwP/H/D/9/8AAAAAAAAAAAAAAAAAAAAP/gAA/5gAT+eAHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A+AHAHn+QAZ/4ABf/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAMACADwA4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAHwA4A8/yfzP/H/L/9/8AAAAAAAAAAAAAAAAAAf/gAB/4AAH+QAAAHAAAA4AAAHAAAA4AAAHAAAA4AAAHAAAA4AAAHAAAA4AAAHAAH+T+B/4/4f/v/gAAAAAAAAAAAAAAAAAD/8AAP/AAM/yADwA4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAHwA4A8ACfzAAH/IAB/8AAAAAAAAAAAAAAAAAAf/v/h/4/5n+T+eAHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A+AHAHgAT+YAA/5AAP/gAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAwAAAHAAAA4AAAHAAAA4AAAHAAAA4AAAHAAAA4AAAHAAAAwAAAE/wfwP/H/D/9/8AAAAAAAAAAAAAAAAAAf/v/h/4/5n+T+eAHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A+AHAHn+T+Z/4/5f/v/gAAAAAAAAAAAAAAAAAD/8AAP/AAM/yADwA4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAH4A4A/AHAHwA4A8/yfzP/H/L/9/8AAAAAAAAAAAAAAAAAAA=="),
  48,
  21,
  27
);
};

Graphics.prototype.setFontDSEG7ClassicBoldSmall = function() {  
  return this.setFontCustom(atob("P9/J+PnAADwAA8AAPAADwAA8AAPAADwAA5+Pk/38AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB+Pg/38AAAAAAAAAAAB/IAPnAIDwGA8BgPAYDwGA8BgPAYDwCA5+AE/wAAAAAAAAAAAAAAIAAHAIDwGA8BgPAYDwGA8BgPAYDwCA5+Pk/38AAAAAAAAAAP8AB+AAAIAAGAABgAAYAAGAABgAAYAACAB+Pg/38AAAAAAAAAAP8AJ+AHAIDwGA8BgPAYDwGA8BgPAYDwCA4APkAH8AAAAAAAAAAP9/J+PnAIDwGA8BgPAYDwGA8BgPAYDwCA4APkAH8AAAAAAAAAAAAAIAADAAAwAAMAADAAAwAAMAADAAAwAAJ+Pg/38AAAAAAAAAAP9/J+PnAIDwGA8BgPAYDwGA8BgPAYDwCA5+Pk/38AAAAAAAAAAP8AJ+AHAIDwGA8BgPAYDwGA8BgPAYDwCA5+Pk/38AAAAAAAAAA"),
  48,
  15,
  20
);
};

function getSeed() {
  var now = new Date();

  var year = now.getFullYear();
  var month = now.getMonth() + 1;
  var date = now.getDate();
  var hours = Math.floor(now.getMinutes() / 60) + now.getHours();

  var seed = year * 1000000 + month * 10000 + date * 100 + hours;
  return seed;
}

function rndSeed(seed) {
  var x = Math.sin(seed) * 10000;
  return x - Math.floor(x);
}

function getRandomElementFromArray(array) {
  var seed = getSeed();
  var randomIndex = Math.floor(rndSeed(seed) * array.length);
  return array[randomIndex];
}

// Encapsulating the clock functionality in an IIFE (Immediately Invoked Function Expression)
// for avoiding global scope pollution and ensuring proper garbage collection when unloaded
(function() {

  // Bible Verses array
const bibleVerses = [  
  "In the beginning, God created the heavens and the earth. (Gen 1:1)",
  "So God created man in his own image, in the image of God he created him; male and female he created them. (Gen 1:27)",
  "I will put enmity between you and the woman, and between your offspring and her offspring; he shall bruise your head, and you shall bruise his heel. (Gen 3:15)",
  "And I will make of you a great nation, and I will bless you and make your name great, so that you will be a blessing. (Gen 12:2)",
  "God said to Moses, 'I AM WHO I AM.' And he said, 'Say this to the people of Israel: 'I AM has sent me to you.'' (Exo 3:14)",
  "The LORD will fight for you, and you have only to be silent. (Exo 14:14)",
  "I am the LORD your God, who brought you out of the land of Egypt, out of the house of slavery. (Exo 20:2)",
  "Hear, O Israel: The LORD our God, the LORD is one. (Deu 6:4)",
  "You shall love the LORD your God with all your heart and with all your soul and with all your might. (Deu 6:5)",
  "Have I not commanded you? Be strong and courageous. Do not be frightened, and do not be dismayed, for the LORD your God is with you wherever you go. (Jos 1:9)",
  "The LORD sees not as man sees: man looks on the outward appearance, but the LORD looks on the heart.' (1Sa 16:7)",
  "For I know that my Redeemer lives, and at the last he will stand upon the earth. (Job 19:25)",
  "The heavens declare the glory of God, and the sky above proclaims his handiwork. (Psa 19:1)",
  "The LORD is my shepherd; I shall not want. (Psa 23:1)",
  "Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me. (Psa 23:4)",
  "The LORD is my strength and my shield; in him my heart trusts, and I am helped; my heart exults, and with my song I give thanks to him. (Psa 28:7)",
  "Oh, taste and see that the LORD is good! Blessed is the man who takes refuge in him! (Psa 34:8)",
  "Delight yourself in the LORD, and he will give you the desires of your heart. (Psa 37:4)",
  "God is our refuge and strength, a very present help in trouble. (Psa 46:1)",
  "'Be still, and know that I am God. I will be exalted among the nations, I will be exalted in the earth!' (Psa 46:10)",
  "Create in me a clean heart, O God, and renew a right spirit within me. (Psa 51:10)",
  "The sacrifices of God are a broken spirit; a broken and contrite heart, O God, you will not despise. (Psa 51:17)",
  "For the LORD is good; his steadfast love endures forever, and his faithfulness to all generations. (Psa 100:5)",
  "As a father shows compassion to his children, so the LORD shows compassion to those who fear him. (Psa 103:13)",
  "How can a young man keep his way pure? By guarding it according to your word. I have stored up your word in my heart, that I might not sin against you. (Psa 119:11)",
  "Your word is a lamp to my feet and a light to my path. (Psa 119:105)",
  "I praise you, for I am fearfully and wonderfully made. Wonderful are your works; my soul knows it very well. (Psa 139:14)",
  "Let everything that has breath praise the LORD! Praise the LORD! (Psa 150:6)",
  "Trust in the LORD with all your heart, and do not lean on your own understanding. In all your ways acknowledge him, and he will make straight your paths. (Pro 3:5-6)",
  "Trust in the LORD with all your heart, and do not lean on your own understanding. (Pro 3:5)",
  "The fear of the LORD is the beginning of wisdom, and the knowledge of the Holy One is insight. (Pro 9:10)",
  "Commit your work to the LORD, and your plans will be established. (Pro 16:3)",
  "The name of the LORD is a strong tower; the righteous man runs into it and is safe. (Pro 18:10)",
  "Every word of God proves true; he is a shield to those who take refuge in him. Do not add to his words, lest he rebuke you and you be found a liar. (Pro 30:5-6)",
  "For everything there is a season, and a time for every matter under heaven: (Ecc 3:1)",
  "And his name shall be called Wonderful Counselor, Mighty God, Everlasting Father, Prince of Peace. (Isa 9:6)",
  "You keep him in perfect peace whose mind is stayed on you, because he trusts in you. (Isa 26:3)",
  "The grass withers, the flower fades, but the word of our God will stand forever. (Isa 40:8)",
  "but they who wait for the LORD shall renew their strength; they shall mount up with wings like eagles; they shall run and not be weary; they shall walk and not faint. (Isa 40:31)",
  "fear not, for I am with you; be not dismayed, for I am your God; I will strengthen you, I will help you, I will uphold you with my righteous right hand. (Isa 41:10)",
  "For I, the LORD your God, hold your right hand; it is I who say to you, 'Fear not, I am the one who helps you.' (Isa 41:13)",
  "When you pass through the waters, I will be with you; and through the rivers, they shall not overwhelm you (Isa 43:2)",
  "For I know the plans I have for you, declares the LORD, plans for welfare and not for evil, to give you a future and a hope. (Jer 29:11)",
  "You will seek me and find me, when you seek me with all your heart. (Jer 29:13)",
  "the LORD appeared to him from far away. I have loved you with an everlasting love; therefore I have continued my faithfulness to you. (Jer 31:3)",
  "The steadfast love of the LORD never ceases; his mercies never come to an end (Lam 3:22)",
  "And I will give you a new heart, and a new spirit I will put within you. And I will remove the heart of stone from your flesh and give you a heart of flesh. (Eze 36:26)",
  "I saw in the night visions,  and behold, with the clouds of heaven there came one like a son of man, and he came to the Ancient of Days and was presented before him. (Dan 7:13)",
  "And to him was given dominion and glory and a kingdom, that all peoples, nations, and languages should serve him (Dan 7:14)",
  "And many of those who sleep in the dust of the earth shall awake, some to everlasting life, and some to shame and everlasting contempt. (Dan 12:2)",
  "From you shall come forth for me one who is to be ruler in Israel, whose coming forth is from of old, from ancient days. (Mic 5:2)",
  "He has told you, O man, what is good; and what does the LORD require of you but to do justice, and to love kindness, and to walk humbly with your God? (Mic 6:8)",
  "Behold, his soul is puffed up; it is not upright within him, but the righteous shall live by his faith. (Hab 2:4)",
  "Behold, your king is coming to you; righteous and having salvation is he, humble and mounted on a donkey, on a colt, the foal of a donkey. (Zec 9:9)",
  "For I the LORD do not change; therefore you, O children of Jacob, are not consumed. (Mal 3:6)",
  "But he answered, It is written,  'Man shall not live by bread alone, but by every word that comes from the mouth of God.' (Mat 4:4)",
  "Blessed are the peacemakers, for they shall be called sons of God. (Mat 5:9)",
  "But seek first the kingdom of God and his righteousness, and all these things will be added to you. (Mat 6:33)",
  "Come to me, all who labor and are heavy laden, and I will give you rest. (Mat 11:28)",
  "Take my yoke upon you, and learn from me, for I am gentle and lowly in heart, and you will find rest for your souls. For my yoke is easy, and my burden is light. (Mat 11:29-30)",
  "Now as they were eating, Jesus took bread, and after blessing it broke it and gave it to the disciples, and said, 'Take, eat; this is my body.' (Mat 26:26)",
  "Go therefore and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit (Mat 28:19)",
  "teaching them to observe all that I have commanded you. And behold, I am with you always, to the end of the age. (Mat 28:20)",
  "And he answered, 'You shall love the Lord your God with all your heart and with all your soul and with all your strength and with all your mind, and your neighbor as yourself.' (Luk 10:27)",
  "And the Word became flesh and dwelt among us, and we have seen his glory, glory as of the only Son from the Father, full of grace and truth. (Joh 1:14)",
  "For God did not send his Son into the world to condemn the world, but in order that the world might be saved through him. (Joh 3:17)",
  "and you will know the truth, and the truth will set you free. (Joh 8:32)",
  "I am the good shepherd. The good shepherd lays down his life for the sheep. (Joh 10:11)",
  "Jesus said to him, I am the way, and the truth, and the life. No one comes to the Father except through me. (Joh 14:6)",
  "I am the vine; you are the branches. Whoever abides in me and I in him, he it is that bears much fruit, for apart from me you can do nothing. (Joh 15:5)",
  "I have said these things to you, that in me you may have peace. In the world you will have tribulation. But take heart; I have overcome the world. (Joh 16:33)",
  "But we believe that we will be saved through the grace of the Lord Jesus, just as they will. (Act 15:11)",
  "Now these Jews were more noble than those in Thessalonica; they received the word with all eagerness, examining the Scriptures daily to see if these things were so. (Act 17:11)",
  "for all have sinned and fall short of the glory of God, and are justified by his grace as a gift, through the redemption that is in Christ Jesus (Rom 3:23-24)",
  "and are justified by his grace as a gift, through the redemption that is in Christ Jesus (Rom 3:24)",
  "For we hold that one is justified by faith apart from works of the law. (Rom 3:28)",
  "And to the one who does not work but believes in him who justifies the ungodly, his faith is counted as righteousness (Rom 4:5)",
  "Therefore, since we have been justified by faith, we have peace with God through our Lord Jesus Christ. (Rom 5:1)",
  "but God shows his love for us in that while we were still sinners, Christ died for us. (Rom 5:8)",
  "For the wages of sin is death, but the free gift of God is eternal life in Christ Jesus our Lord. (Rom 6:23)",
  "There is therefore now no condemnation for those who are in Christ Jesus. (Rom 8:1)",
  "And we know that for those who love God all things work together for good, for those who are called according to his purpose. (Rom 8:28)",
  "because, if you confess with your mouth that Jesus is Lord and believe in your heart that God raised him from the dead, you will be saved. (Rom 10:9)",
  "But if it is by grace, it is no longer on the basis of works; otherwise grace would no longer be grace. (Rom 11:6)",
  "Do not be conformed to this world, but be transformed by the renewal of your mind, that by testing you may discern what is the will of God (Rom 12:2)",
  "For as often as you eat this bread and drink the cup, you proclaim the Lord's death until he comes. (1Co 11:26)",
  "So now faith, hope, and love abide, these three; but the greatest of these is love. (1Co 13:13)",
  "But thanks be to God, who gives us the victory through our Lord Jesus Christ. (1Co 15:57)",
  "Be watchful, stand firm in the faith, act like men, be strong. (1Co 16:13)",
  "Let all that you do be done in love. (1Co 16:14)",
  "So we do not lose heart. Though our outer self is wasting away, our inner self is being renewed day by day. (2Co 4:16)",
  "For this light momentary affliction is preparing for us an eternal weight of glory beyond all comparison (2Co 4:17)",
  "as we look not to the things that are seen but to the things that are unseen. For the things that are seen are transient, but the things that are unseen are eternal. (2Co 4:18)",
  "Therefore, if anyone is in Christ, he is a new creation. The old has passed away; behold, the new has come. (2Co 5:17)",
  "I will boast all the more gladly of my weaknesses, so that the power of Christ may rest upon me. (2Co 12:9)",
  "we also have believed in Christ Jesus, in order to be justified by faith in Christ and not by works of the law, because by works of the law no one will be justified. (Gal 2:16)",
  "The life I now live in the flesh I live by faith in the Son of God, who loved me and gave himself for me. (Gal 2:20)",
  "I do not nullify the grace of God, for if righteousness were through the law, then Christ died for no purpose. (Gal 2:21)",
  "Now it is evident that no one is justified before God by the law, for 'The righteous shall live by faith.' (Gal 3:11)",
  "For as many of you as were baptized into Christ have put on Christ. (Gal 3:27)",
  "But the fruit of the Spirit is love, joy, peace, patience, kindness, goodness, faithfulness, gentleness, self-control (Gal 5:22-23)",
  "For by grace you have been saved through faith. And this is not your own doing; it is the gift of God, not a result of works, so that no one may boast. (Eph 2:8-9)",
  "Finally, be strong in the Lord and in the strength of his might. Put on the whole armor of God, that you may be able to stand against the schemes of the devil. (Eph 6:10-11)",
  "For we do not wrestle against flesh and blood, but against the rulers, against the authorities, against the cosmic powers over this present darkness (Eph 6:12)",
  "do not be anxious about anything, but in everything by prayer and supplication with thanksgiving let your requests be made known to God. (Php 4:6)",
  "And the peace of God, which surpasses all understanding, will guard your hearts and your minds in Christ Jesus. (Php 4:7)",
  "I can do all things through him who strengthens me. (Php 4:13)",
  "And whatever you do, in word or deed, do everything in the name of the Lord Jesus, giving thanks to God the Father through him. (Col 3:17)",
  "Whatever you do, work heartily, as for the Lord and not for men, knowing that from the Lord you will receive the inheritance as your reward. You are serving the Lord Christ. (Col 3:23-24)",
  "Whatever you do, work heartily, as for the Lord and not for men (Col 3:23)",
  "Rejoice always, pray without ceasing, give thanks in all circumstances; for this is the will of God in Christ Jesus for you. (1Th 5:16-18)",
  "who saved us and called us to a holy calling, not because of our works but because of his own purpose and grace, which he gave us in Christ Jesus before the ages began (2Ti 1:9)",
  "All Scripture is breathed out by God and profitable for teaching, for reproof, for correction, and for training in righteousness (2Ti 3:16)",
  "so that being justified by his grace we might become heirs according to the hope of eternal life. (Tit 3:7)",
  "For the word of God is living and active, sharper than any two-edged sword, piercing to the division of soul and of spirit (Heb 4:12)",
  "Now faith is the assurance of things hoped for, the conviction of things not seen. (Heb 11:1)",
  "Count it all joy, my brothers, when you meet trials of various kinds, for you know that the testing of your faith produces steadfastness. (Jam 1:2-3)",
  "He himself bore our sins in his body on the tree, that we might die to sin and live to righteousness. By his wounds you have been healed. (1Pe 2:24)",
  "casting all your anxieties on him, because he cares for you. (1Pe 5:7)",
  "If we confess our sins, he is faithful and just to forgive us our sins and to cleanse us from all unrighteousness. (1Jo 1:9)",
  "Anyone who does not love does not know God, because God is love. (1Jo 4:8)",
  "In this the love of God was made manifest among us, that God sent his only Son into the world, so that we might live through him. (1Jo 4:9)",
  "Behold, I stand at the door and knock. If anyone hears my voice and opens the door, I will come in to him and eat with him, and he with me. (Rev 3:20)",
  "Behold, I am coming soon, bringing my recompense with me, to repay each one for what he has done. (Rev 22:12)"
  ];

  let initializedText = null;
  let drawTimeout;
  
  function generateText() {
    g.reset().clearRect(Bangle.appRect);
    initializedText = getRandomElementFromArray(bibleVerses);
    console.log("String refreshed:", initializedText);

    // Draw Bible Verse
    g.setFontAlign(-1, -1).setFont("HaxorNarrow7x17", 1).drawString(g.wrapString(initializedText, g.getWidth()).join("\n"), 0, 70);

    //const millisecondsToNextRefresh = 15000 - (Date.now() % 15000); // Refresh at 00, 15, 30 and 45 seconds
    const millisecondsToNextRefresh = 3600000 - (Date.now() % 3600000); // Refresh at the top of every hour
    setTimeout(generateText, millisecondsToNextRefresh);
    g.setColor(0,0,0);
  }

  // Function to draw the clock face
  let draw = function() {
    if (initializedText === null) {
      generateText();
    }


    //g.reset().clearRect(Bangle.appRect); // Clear whole background (w/o widgets)
    g.setBgColor(1,1,1);
    g.setColor(0,0,0);
    g.clearRect(0,24,176,72); //Just clear the time. Makes it so the text generation logic only needs to run every hour.    

    const date = new Date();
    const timeStr = require("locale").time(date, 1); // Get current time

    // Draw time string in hours and minutes
    g.setFont("DSEG7ClassicBold");
    g.setFontAlign(0, -1).drawString(timeStr, 77, 30);    

    // Draw seconds string
    const seconds = date.getSeconds();
    const formattedSeconds = seconds < 10 ? "0" + seconds : seconds;
    g.setFont("DSEG7ClassicBoldMed");
    g.drawString(formattedSeconds, 157, 33);

    // Draw day of month
    const dayOfMonth = date.getDate();
    const formattedDayOfMonth = dayOfMonth < 10 ? "0" + dayOfMonth : dayOfMonth;
    g.setFont("DSEG7ClassicBoldSmall");
    g.drawString(formattedDayOfMonth, 15, 46);

    // Queue next draw after one second
    if (drawTimeout) clearTimeout(drawTimeout);
    drawTimeout = setTimeout(draw, 1000 - (Date.now() % 1000));
  };

  // Handle middle button press to show launcher
  Bangle.setUI({
    mode: "clock",
    remove: function () {
      // Unload clock app
      if (drawTimeout) clearTimeout(drawTimeout);
      drawTimeout = undefined;
    }
  });

  // Load widgets and draw clock
  Bangle.loadWidgets();
  draw();
  setTimeout(Bangle.drawWidgets, 0);
})();